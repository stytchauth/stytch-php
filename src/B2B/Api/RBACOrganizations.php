<?php

// !!!
// WARNING: This file is autogenerated
// Only modify code within MANUAL() sections
// or your changes may be overwritten later!
// !!!

namespace Stytch\B2B\Api;

use Stytch\Core\Client;

class RBACOrganizations
{
    private Client $client;


    public function __construct(Client $client)
    {
        $this->client = $client;

    }

    /**
        * Get the active RBAC Policy for a specific Organization within your Stytch Project. An Organization RBAC
        * Policy contains the roles that have been defined specifically for that organization, allowing for
        * organization-specific permissioning models.
        *
        * This endpoint returns the organization-scoped roles that supplement the project-level RBAC policy.
        * Organization policies allow you to define custom roles that are specific to individual organizations
        * within your project.
        *
        * When using the backend SDKs, the RBAC Policy will be cached to allow for local evaluations, eliminating
        * the need for an extra request to Stytch. The policy will be refreshed if an authorization check is
        * requested and the RBAC policy was last updated more than 5 minutes ago.
        *
        * Organization-specific roles can be created and managed through this API endpoint, providing fine-grained
        * control over permissions at the organization level.
        *
        * Check out the [RBAC overview](https://stytch.com/docs/b2b/guides/rbac/overview) to learn more about
        * Stytch's RBAC permissioning model and organization-scoped policies.

         * @param \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyRequest|array $request
         * @return \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyResponse
         */
    public function getOrgPolicy(
        \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyRequest|array $request,
    ): \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyResponse {
        $data = is_array($request) ? $request : $request->toArray();
        $response = $this->client->get('/v1/b2b/rbac/organizations/{organization_id}', $data);
        return \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyResponse::fromArray($response);
    }

    /**
    * Get the active RBAC Policy for a specific Organization within your Stytch Project. An Organization RBAC
    * Policy contains the roles that have been defined specifically for that organization, allowing for
    * organization-specific permissioning models.
    *
    * This endpoint returns the organization-scoped roles that supplement the project-level RBAC policy.
    * Organization policies allow you to define custom roles that are specific to individual organizations
    * within your project.
    *
    * When using the backend SDKs, the RBAC Policy will be cached to allow for local evaluations, eliminating
    * the need for an extra request to Stytch. The policy will be refreshed if an authorization check is
    * requested and the RBAC policy was last updated more than 5 minutes ago.
    *
    * Organization-specific roles can be created and managed through this API endpoint, providing fine-grained
    * control over permissions at the organization level.
    *
    * Check out the [RBAC overview](https://stytch.com/docs/b2b/guides/rbac/overview) to learn more about
    * Stytch's RBAC permissioning model and organization-scoped policies.

     * @param \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyRequest|array $request
     * @return \GuzzleHttp\Promise\PromiseInterface
     */
    public function getOrgPolicyAsync(
        \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyRequest|array $request,
    ): \GuzzleHttp\Promise\PromiseInterface {
        $data = is_array($request) ? $request : $request->toArray();
        $promise = $this->client->getAsync('/v1/b2b/rbac/organizations/{organization_id}', $data);
        return $promise->then(function ($response) {
            return \Stytch\B2B\Models\RBAC\Organizations\GetOrgPolicyResponse::fromArray($response);
        });
    }

    /**
        * Set the RBAC Policy for a specific Organization within your Stytch Project. An Organization RBAC Policy
        * allows you to define roles that are specific to that organization, providing fine-grained control over
        * permissions at the organization level.
        *
        * This endpoint allows you to create, update, or replace the organization-scoped roles for a given
        * organization. Organization policies supplement the project-level RBAC policy with additional roles that
        * are only applicable within the context of that specific organization.
        *
        * The organization policy consists of roles, where each role defines:
        * - A unique `role_id` to identify the role
        * - A human-readable `description` of the role's purpose
        * - A set of `permissions` that specify which actions can be performed on which resources
        *
        * When you set an organization policy, it will replace any existing organization-specific roles for that
        * organization. The project-level RBAC policy remains unchanged.
        *
        * Organization-specific roles are useful for scenarios where different organizations within your project
        * require different permission structures, such as:
        * - Multi-tenant applications with varying access levels per tenant
        * - Organizations with custom approval workflows
        * - Different organizational hierarchies requiring unique role definitions
        *
        * Check out the [RBAC overview](https://stytch.com/docs/b2b/guides/rbac/overview) to learn more about
        * Stytch's RBAC permissioning model and organization-scoped policies.

         * @param \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyRequest|array $request
         * @return \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyResponse
         */
    public function setOrgPolicy(
        \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyRequest|array $request,
    ): \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyResponse {
        $data = is_array($request) ? $request : $request->toArray();
        $response = $this->client->put('/v1/b2b/rbac/organizations/{organization_id}', $data);
        return \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyResponse::fromArray($response);
    }

    /**
    * Set the RBAC Policy for a specific Organization within your Stytch Project. An Organization RBAC Policy
    * allows you to define roles that are specific to that organization, providing fine-grained control over
    * permissions at the organization level.
    *
    * This endpoint allows you to create, update, or replace the organization-scoped roles for a given
    * organization. Organization policies supplement the project-level RBAC policy with additional roles that
    * are only applicable within the context of that specific organization.
    *
    * The organization policy consists of roles, where each role defines:
    * - A unique `role_id` to identify the role
    * - A human-readable `description` of the role's purpose
    * - A set of `permissions` that specify which actions can be performed on which resources
    *
    * When you set an organization policy, it will replace any existing organization-specific roles for that
    * organization. The project-level RBAC policy remains unchanged.
    *
    * Organization-specific roles are useful for scenarios where different organizations within your project
    * require different permission structures, such as:
    * - Multi-tenant applications with varying access levels per tenant
    * - Organizations with custom approval workflows
    * - Different organizational hierarchies requiring unique role definitions
    *
    * Check out the [RBAC overview](https://stytch.com/docs/b2b/guides/rbac/overview) to learn more about
    * Stytch's RBAC permissioning model and organization-scoped policies.

     * @param \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyRequest|array $request
     * @return \GuzzleHttp\Promise\PromiseInterface
     */
    public function setOrgPolicyAsync(
        \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyRequest|array $request,
    ): \GuzzleHttp\Promise\PromiseInterface {
        $data = is_array($request) ? $request : $request->toArray();
        $promise = $this->client->putAsync('/v1/b2b/rbac/organizations/{organization_id}', $data);
        return $promise->then(function ($response) {
            return \Stytch\B2B\Models\RBAC\Organizations\SetOrgPolicyResponse::fromArray($response);
        });
    }

}
