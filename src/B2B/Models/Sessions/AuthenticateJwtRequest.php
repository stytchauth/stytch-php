<?php

// !!!
// WARNING: This file is autogenerated
// Only modify code within MANUAL() sections
// or your changes may be overwritten later!
// !!!

namespace Stytch\B2B\Models\Sessions;

final class AuthenticateJwtRequest
{
    /** The JWT to authenticate. */
    public string $sessionJwt;

    /**
     * If max_token_age_seconds is set, the JWT must have been issued (based on the "iat" claim) no more
     * than this many seconds ago. If the JWT is older, it will fall back to remote authentication.
     */
    public ?int $maxTokenAgeSeconds = null;

    /**
     * If an `authorization_check` object is passed in, this endpoint will also check if the Member is
     * authorized to perform the given action on the given Resource. A Member is authorized if they are
     * assigned a Role with adequate permissions.
     *
     * If the Member is not authorized to perform the specified action on the specified Resource, a 403 error
     * will be thrown. Otherwise, the response will contain a list of Roles that satisfied the authorization check.
     */
    public ?AuthorizationCheck $authorizationCheck = null;

    public function __construct(
        string $sessionJwt,
        ?int $maxTokenAgeSeconds = null,
        ?AuthorizationCheck $authorizationCheck = null
    ) {
        $this->sessionJwt = $sessionJwt;
        $this->maxTokenAgeSeconds = $maxTokenAgeSeconds;
        $this->authorizationCheck = $authorizationCheck;
    }

    /**
     * Create an instance from an array
     *
     * @param array $data
     * @return static
     */
    public static function fromArray(array $data): static
    {
        return new static(
            $data['session_jwt'],
            $data['max_token_age_seconds'] ?? null,
            isset($data['authorization_check']) && $data['authorization_check'] !== null ? AuthorizationCheck::fromArray($data['authorization_check']) : null
        );
    }

    /**
     * Convert to array
     *
     * @return array
     */
    public function toArray(): array
    {
        return [
            'session_jwt' => $this->sessionJwt,
            'max_token_age_seconds' => $this->maxTokenAgeSeconds,
            'authorization_check' => $this->authorizationCheck,
        ];
    }
}
